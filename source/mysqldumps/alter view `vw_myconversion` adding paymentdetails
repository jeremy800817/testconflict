DROP VIEW  IF EXISTS `vw_myconversion`;
CREATE VIEW `vw_myconversion`  AS  select `c`.*,`r`.`rdm_status` AS `cvn_rdmstatus`,`r`.`rdm_partnerid` AS `cvn_rdmpartnerid`,`r`.`rdm_branchid` AS `cvn_rdmbranchid`,`r`.`rdm_salespersonid` AS `cvn_rdmsalespersonid`,`r`.`rdm_partnerrefno` AS `cvn_rdmpartnerrefno`,`r`.`rdm_redemptionno` AS `cvn_rdmredemptionno`,`r`.`rdm_apiversion` AS `cvn_rdmapiversion`,`r`.`rdm_type` AS `cvn_rdmtype`,`r`.`rdm_sapredemptioncode` AS `cvn_rdmsapredemptioncode`,`r`.`rdm_redemptionfee` AS `cvn_rdmredemptionfee`,`r`.`rdm_insurancefee` AS `cvn_rdminsurancefee`,`r`.`rdm_handlingfee` AS `cvn_rdmhandlingfee`,`r`.`rdm_specialdeliveryfee` AS `cvn_rdmspecialdeliveryfee`,`r`.`rdm_totalweight` AS `cvn_rdmtotalweight`,`r`.`rdm_totalquantity` AS `cvn_rdmtotalquantity`,`r`.`rdm_items` AS `cvn_rdmitems`,`r`.`rdm_bookingon` AS `cvn_rdmbookingon`,`r`.`rdm_bookingprice` AS `cvn_rdmbookingprice`,`r`.`rdm_bookingpricestreamid` AS `cvn_rdmbookingpricestreamid`,`r`.`rdm_confirmon` AS `cvn_rdmconfirmon`,`r`.`rdm_confirmby` AS `cvn_rdmconfirmby`,`r`.`rdm_confirmpricestreamid` AS `cvn_rdmconfirmpricestreamid`,`r`.`rdm_confirmprice` AS `cvn_rdmconfirmprice`,`r`.`rdm_confirmreference` AS `cvn_rdmconfirmreference`,`r`.`rdm_deliveryaddress1` AS `cvn_rdmdeliveryaddress1`,`r`.`rdm_deliveryaddress2` AS `cvn_rdmdeliveryaddress2`,`r`.`rdm_deliveryaddress3` AS `cvn_rdmdeliveryaddress3`,concat_ws(', ',concat_ws(', ',`r`.`rdm_deliveryaddress1`,`r`.`rdm_deliveryaddress2`),concat_ws(', ',`r`.`rdm_deliveryaddress3`,`r`.`rdm_deliverycity`)) AS `cvn_rdmdeliveryaddress`,`r`.`rdm_deliverycity` AS `cvn_rdmdeliverycity`,`r`.`rdm_deliverypostcode` AS `cvn_rdmdeliverypostcode`,`r`.`rdm_deliverystate` AS `cvn_rdmdeliverystate`,`r`.`rdm_deliverycountry` AS `cvn_rdmdeliverycountry`,`r`.`rdm_deliverycontactname1` AS `cvn_rdmdeliverycontactname1`,`r`.`rdm_deliverycontactname2` AS `cvn_rdmdeliverycontactname2`,`r`.`rdm_deliverycontactno1` AS `cvn_rdmdeliverycontactno1`,`r`.`rdm_deliverycontactno2` AS `cvn_rdmdeliverycontactno2`,`r`.`rdm_appointmentbranchid` AS `cvn_rdmappointmentbranchid`,`r`.`rdm_appointmentdatetime` AS `cvn_rdmappointmentdatetime`,`r`.`rdm_appointmenton` AS `cvn_rdmappointmenton`,`r`.`rdm_appointmentby` AS `cvn_rdmappointmentby`,`r`.`rdm_reconciled` AS `cvn_rdmreconciled`,`r`.`rdm_reconciledon` AS `cvn_rdmreconciledon`,`r`.`rdm_reconciledby` AS `cvn_rdmreconciledby`,`a`.`ach_fullname` AS `cvn_accountholdername`,`a`.`ach_accountholdercode` AS `cvn_accountholdercode`,`a`.`ach_type` AS `cvn_accounttype`,(case when (`a`.`ach_type` = 1) then 'Premium' else 'Basic' end) AS `cvn_accounttypename`,`p`.`pdt_amount` AS `cvn_pdtamount`,`p`.`pdt_sourcerefno` AS `cvn_pdtsourcerefno`,`p`.`pdt_signeddata` AS `cvn_pdtsigneddata`,`p`.`pdt_location` AS `cvn_pdtlocation`,`p`.`pdt_gatewayfee` AS `cvn_pdtgatewayfee`,`p`.`pdt_customerfee` AS `cvn_pdtcustomerfee`,`p`.`pdt_token` AS `cvn_pdttoken`,`p`.`pdt_status` AS `cvn_pdtstatus`,`p`.`pdt_transactiondate` AS `cvn_pdttransactiondate`,`p`.`pdt_successon` AS `cvn_pdtsuccesson`,`p`.`pdt_failedon` AS `cvn_pdtfailedon`,`p`.`pdt_refundedon` AS `cvn_pdtrefundedon` from (((`myconversion` `c` left join `redemption` `r` on((`c`.`cvn_redemptionid` = `r`.`rdm_id`))) left join `myaccountholder` `a` on((`c`.`cvn_accountholderid` = `a`.`ach_id`))) left join `vw_mypaymentdetail` `p` on((`c`.`cvn_refno` = `p`.`pdt_sourcerefno`))) ;

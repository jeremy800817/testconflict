CREATE OR REPLACE VIEW `vw_myconversion` AS select `c`.`cvn_id` AS `cvn_id`,`c`.`cvn_accountholderid` AS `cvn_accountholderid`,`c`.`cvn_refno` AS `cvn_refno`,`c`.`cvn_redemptionid` AS `cvn_redemptionid`,`c`.`cvn_productid` AS `cvn_productid`,`c`.`cvn_commissionfee` AS `cvn_commissionfee`,`c`.`cvn_premiumfee` AS `cvn_premiumfee`,`c`.`cvn_courierfee` AS `cvn_courierfee`,`c`.`cvn_handlingfee` AS `cvn_handlingfee`,`c`.`cvn_logisticfeepaymentmode` AS `cvn_logisticfeepaymentmode`,`c`.`cvn_status` AS `cvn_status`,`c`.`cvn_createdon` AS `cvn_createdon`,`c`.`cvn_createdby` AS `cvn_createdby`,`c`.`cvn_modifiedon` AS `cvn_modifiedon`,`c`.`cvn_modifiedby` AS `cvn_modifiedby`,`c`.`cvn_campaigncode` AS `cvn_campaigncode`,`r`.`rdm_partnerid` AS `cvn_rdmpartnerid`,
`r`.`rdm_branchid` AS `cvn_rdmbranchid`,
`partnerbranchmap`.`pbm_name` AS `cvn_rdmbranchname`,
`r`.`rdm_salespersonid` AS `cvn_rdmsalespersonid`,`r`.`rdm_partnerrefno` AS `cvn_rdmpartnerrefno`,`r`.`rdm_redemptionno` AS `cvn_rdmredemptionno`,`r`.`rdm_apiversion` AS `cvn_rdmapiversion`,`r`.`rdm_type` AS `cvn_rdmtype`,`r`.`rdm_sapredemptioncode` AS `cvn_rdmsapredemptioncode`,`r`.`rdm_redemptionfee` AS `cvn_rdmredemptionfee`,`r`.`rdm_insurancefee` AS `cvn_rdminsurancefee`,`r`.`rdm_handlingfee` AS `cvn_rdmhandlingfee`,`r`.`rdm_specialdeliveryfee` AS `cvn_rdmspecialdeliveryfee`,`r`.`rdm_totalweight` AS `cvn_rdmtotalweight`,`r`.`rdm_totalquantity` AS `cvn_rdmtotalquantity`,`r`.`rdm_items` AS `cvn_rdmitems`,`r`.`rdm_bookingon` AS `cvn_rdmbookingon`,`r`.`rdm_bookingprice` AS `cvn_rdmbookingprice`,`r`.`rdm_bookingpricestreamid` AS `cvn_rdmbookingpricestreamid`,`r`.`rdm_confirmon` AS `cvn_rdmconfirmon`,`r`.`rdm_confirmby` AS `cvn_rdmconfirmby`,`r`.`rdm_confirmpricestreamid` AS `cvn_rdmconfirmpricestreamid`,`r`.`rdm_confirmprice` AS `cvn_rdmconfirmprice`,`r`.`rdm_confirmreference` AS `cvn_rdmconfirmreference`,`r`.`rdm_deliveryaddress1` AS `cvn_rdmdeliveryaddress1`,`r`.`rdm_deliveryaddress2` AS `cvn_rdmdeliveryaddress2`,`r`.`rdm_deliveryaddress3` AS `cvn_rdmdeliveryaddress3`,concat_ws(', ',concat_ws(', ',`r`.`rdm_deliveryaddress1`,`r`.`rdm_deliveryaddress2`),concat_ws(', ',`r`.`rdm_deliveryaddress3`,`r`.`rdm_deliverycity`)) AS `cvn_rdmdeliveryaddress`,`r`.`rdm_deliverycity` AS `cvn_rdmdeliverycity`,`r`.`rdm_deliverypostcode` AS `cvn_rdmdeliverypostcode`,`r`.`rdm_deliverystate` AS `cvn_rdmdeliverystate`,`r`.`rdm_deliverycountry` AS `cvn_rdmdeliverycountry`,`r`.`rdm_deliverycontactname1` AS `cvn_rdmdeliverycontactname1`,`r`.`rdm_deliverycontactname2` AS `cvn_rdmdeliverycontactname2`,`r`.`rdm_deliverycontactno1` AS `cvn_rdmdeliverycontactno1`,`r`.`rdm_deliverycontactno2` AS `cvn_rdmdeliverycontactno2`,`r`.`rdm_appointmentbranchid` AS `cvn_rdmappointmentbranchid`,`r`.`rdm_appointmentdatetime` AS `cvn_rdmappointmentdatetime`,`r`.`rdm_appointmenton` AS `cvn_rdmappointmenton`,`r`.`rdm_appointmentby` AS `cvn_rdmappointmentby`,`r`.`rdm_reconciled` AS `cvn_rdmreconciled`,`r`.`rdm_reconciledon` AS `cvn_rdmreconciledon`,`r`.`rdm_reconciledby` AS `cvn_rdmreconciledby`,`r`.`rdm_status` AS `cvn_rdmstatus`,`a`.`ach_fullname` AS `cvn_accountholdername`,`a`.`ach_accountholdercode` AS `cvn_accountholdercode`,`a`.`ach_type` AS `cvn_accounttype`,(case when (`a`.`ach_type` = 1) then 'Premium' else 'Basic' end) AS `cvn_accounttypename`,`p`.`pdt_amount` AS `cvn_pdtamount`,`p`.`pdt_sourcerefno` AS `cvn_pdtsourcerefno`,`p`.`pdt_signeddata` AS `cvn_pdtsigneddata`,`p`.`pdt_location` AS `cvn_pdtlocation`,`p`.`pdt_gatewayfee` AS `cvn_pdtgatewayfee`,`p`.`pdt_customerfee` AS `cvn_pdtcustomerfee`,`p`.`pdt_token` AS `cvn_pdttoken`,`p`.`pdt_status` AS `cvn_pdtstatus`,`p`.`pdt_transactiondate` AS `cvn_pdttransactiondate`,`p`.`pdt_successon` AS `cvn_pdtsuccesson`,`p`.`pdt_failedon` AS `cvn_pdtfailedon`,`p`.`pdt_refundedon` AS `cvn_pdtrefundedon` from (((`myconversion` `c` left join `redemption` `r` on((`c`.`cvn_redemptionid` = `r`.`rdm_id`))) left join `myaccountholder` `a` on((`c`.`cvn_accountholderid` = `a`.`ach_id`))) left join `vw_mypaymentdetail` `p` on((`c`.`cvn_refno` = `p`.`pdt_sourcerefno`)))
left join `partnerbranchmap` on((`partnerbranchmap`.`pbm_code` = `r`.`rdm_branchid`))



CREATE OR REPLACE VIEW `vw_redemption` AS select `redemption`.`rdm_id` AS `rdm_id`,`redemption`.`rdm_partnerid` AS `rdm_partnerid`,`redemption`.`rdm_branchid` AS `rdm_branchid`,`redemption`.`rdm_salespersonid` AS `rdm_salespersonid`,`redemption`.`rdm_partnerrefno` AS `rdm_partnerrefno`,`redemption`.`rdm_redemptionno` AS `rdm_redemptionno`,`redemption`.`rdm_apiversion` AS `rdm_apiversion`,`redemption`.`rdm_type` AS `rdm_type`,`redemption`.`rdm_sapredemptioncode` AS `rdm_sapredemptioncode`,`redemption`.`rdm_redemptionfee` AS `rdm_redemptionfee`,`redemption`.`rdm_insurancefee` AS `rdm_insurancefee`,`redemption`.`rdm_handlingfee` AS `rdm_handlingfee`,`redemption`.`rdm_specialdeliveryfee` AS `rdm_specialdeliveryfee`,`redemption`.`rdm_totalweight` AS `rdm_totalweight`,`redemption`.`rdm_totalquantity` AS `rdm_totalquantity`,`redemption`.`rdm_items` AS `rdm_items`,`redemption`.`rdm_bookingon` AS `rdm_bookingon`,`redemption`.`rdm_bookingprice` AS `rdm_bookingprice`,`redemption`.`rdm_bookingpricestreamid` AS `rdm_bookingpricestreamid`,`redemption`.`rdm_confirmon` AS `rdm_confirmon`,`redemption`.`rdm_confirmby` AS `rdm_confirmby`,`redemption`.`rdm_confirmpricestreamid` AS `rdm_confirmpricestreamid`,`redemption`.`rdm_confirmprice` AS `rdm_confirmprice`,`redemption`.`rdm_confirmreference` AS `rdm_confirmreference`,`redemption`.`rdm_deliveryaddress1` AS `rdm_deliveryaddress1`,`redemption`.`rdm_deliveryaddress2` AS `rdm_deliveryaddress2`,`redemption`.`rdm_deliveryaddress3` AS `rdm_deliveryaddress3`,`redemption`.`rdm_deliverycity` AS `rdm_deliverycity`,`redemption`.`rdm_deliverypostcode` AS `rdm_deliverypostcode`,`redemption`.`rdm_deliverystate` AS `rdm_deliverystate`,`redemption`.`rdm_deliverycountry` AS `rdm_deliverycountry`,`redemption`.`rdm_deliverycontactname1` AS `rdm_deliverycontactname1`,`redemption`.`rdm_deliverycontactname2` AS `rdm_deliverycontactname2`,`redemption`.`rdm_deliverycontactno1` AS `rdm_deliverycontactno1`,`redemption`.`rdm_deliverycontactno2` AS `rdm_deliverycontactno2`,`redemption`.`rdm_appointmentbranchid` AS `rdm_appointmentbranchid`,`redemption`.`rdm_appointmentdatetime` AS `rdm_appointmentdatetime`,`redemption`.`rdm_appointmenton` AS `rdm_appointmenton`,`redemption`.`rdm_appointmentby` AS `rdm_appointmentby`,`redemption`.`rdm_reconciled` AS `rdm_reconciled`,`redemption`.`rdm_reconciledon` AS `rdm_reconciledon`,`redemption`.`rdm_reconciledby` AS `rdm_reconciledby`,`redemption`.`rdm_createdon` AS `rdm_createdon`,`redemption`.`rdm_createdby` AS `rdm_createdby`,`redemption`.`rdm_modifiedon` AS `rdm_modifiedon`,`redemption`.`rdm_modifiedby` AS `rdm_modifiedby`,`redemption`.`rdm_status` AS `rdm_status`,`redemption`.`rdm_remarks` AS `rdm_remarks`,`partner`.`par_name` AS `rdm_partnername`,`partner`.`par_code` AS `rdm_partnercode`,
`partnerbranchmap`.`pbm_name` AS `rdm_branchname`,`partnerbranchmap`.`pbm_code` AS `rdm_branchcode`,`partnerbranchmap`.`pbm_sapcode` AS `rdm_branchsapcode`,`salespersonid`.`usr_name` AS `rdm_salespersonname`,`createdby`.`usr_name` AS `rdm_createdbyname`,`modifiedby`.`usr_name` AS `rdm_modifiedbyname`,(case `redemption`.`rdm_status` when 0 then 'Pending' when 1 then 'Confirmed' when 2 then 'Completed' when 3 then 'Failed' when 4 then 'Process Delivery' when 5 then 'Cancelled' when 6 then 'Reversed' end) AS `rdm_statusname` from (((((`redemption` left join `partner` on((`partner`.`par_id` = `redemption`.`rdm_partnerid`))) 
left join `partnerbranchmap` on((`partnerbranchmap`.`pbm_id` = `redemption`.`rdm_branchid`))) left join `user` `salespersonid` on((`salespersonid`.`usr_id` = `redemption`.`rdm_salespersonid`))) left join `user` `createdby` on((`createdby`.`usr_id` = `redemption`.`rdm_createdby`))) left join `user` `modifiedby` on((`modifiedby`.`usr_id` = `redemption`.`rdm_modifiedby`)))

